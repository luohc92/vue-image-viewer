(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("vue")):"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["vue-image-viewer"]=t(require("vue")):e["vue-image-viewer"]=t(e["Vue"])})("undefined"!==typeof self?self:this,(function(e){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="fb15")}({8376:function(e,t,n){},8875:function(e,t,n){var o,i,s;(function(n,r){i=[],o=r,s="function"===typeof o?o.apply(t,i):o,void 0===s||(e.exports=s)})("undefined"!==typeof self&&self,(function(){function e(){var t=Object.getOwnPropertyDescriptor(document,"currentScript");if(!t&&"currentScript"in document&&document.currentScript)return document.currentScript;if(t&&t.get!==e&&document.currentScript)return document.currentScript;try{throw new Error}catch(m){var n,o,i,s=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,r=/@([^@]*):(\d+):(\d+)\s*$/gi,a=s.exec(m.stack)||r.exec(m.stack),c=a&&a[1]||!1,l=a&&a[2]||!1,u=document.location.href.replace(document.location.hash,""),d=document.getElementsByTagName("script");c===u&&(n=document.documentElement.outerHTML,o=new RegExp("(?:[^\\n]+?\\n){0,"+(l-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),i=n.replace(o,"$1").trim());for(var h=0;h<d.length;h++){if("interactive"===d[h].readyState)return d[h];if(d[h].src===c)return d[h];if(c===u&&d[h].innerHTML&&d[h].innerHTML.trim()===i)return d[h]}return null}}return e}))},"8bbf":function(t,n){t.exports=e},b1d6:function(e,t,n){},cb7b:function(e,t,n){"use strict";n("8376")},fb15:function(e,t,n){"use strict";if(n.r(t),"undefined"!==typeof window){var o=window.document.currentScript,i=n("8875");o=i(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:i});var s=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);s&&(n.p=s[1])}var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition",{attrs:{name:"viewer-fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"cool-image-viewer__wrapper",style:"z-index:"+e.zIndex,attrs:{tabindex:"-1"}},[n("div",{staticClass:"cool-image-viewer__mask",style:"background-color:"+e.maskBgColor+";",on:{click:e.handleTapClose}}),n("span",{staticClass:"cool-image-viewer__btn cool-image-viewer__close",on:{click:e.close}},[n("i",{staticClass:"iconfont icon-close"})]),e.images&&e.images.length>1?n("span",{staticClass:"cool-image-viewer__btn cool-image-viewer__pre",on:{click:e.pre}},[n("i",{staticClass:"iconfont icon-arrow-left"})]):e._e(),e.images&&e.images.length>1?n("span",{staticClass:"cool-image-viewer__btn cool-image-viewer__next",on:{click:e.next}},[n("i",{staticClass:"iconfont icon-arrow-right"})]):e._e(),n("div",{staticClass:"cool-image-viewer__image"},[n("img",{directives:[{name:"show",rawName:"v-show",value:e.images&&e.images.length>0&&e.images[e.curIndex],expression:"images && images.length > 0 && images[curIndex]"}],style:e.imgStyle,attrs:{src:e.images[e.curIndex]},on:{mousedown:e.handleMouseDown}})]),n("div",{staticClass:"cool-image-viewer__actions",style:e.actionStyle},[n("div",{staticClass:"cool-image-viewer_actions__inner"},[n("span",{staticClass:"iconfont icon-zoom-out",on:{click:function(t){return e.handleActions("zoomOut")}}}),n("span",{staticClass:"iconfont icon-zoom-in",on:{click:function(t){return e.handleActions("zoomIn")}}}),n("span",{staticClass:"cool-image-viewer__actions__divider"}),n("span",{staticClass:"iconfont icon-refresh-left",on:{click:function(t){return e.handleActions("anticlocelise")}}}),n("span",{staticClass:"iconfont icon-refresh-right",on:{click:function(t){return e.handleActions("clocelise")}}}),n("span",{staticClass:"iconfont icon-mirror",on:{click:function(t){return e.handleActions("mirror")}}}),n("span",{staticClass:"cool-image-viewer__actions__divider"}),n("span",{staticClass:"iconfont",class:e.mode.icon,on:{click:e.toggleMode}}),e.showDownload?[n("span",{staticClass:"cool-image-viewer__actions__divider"}),n("span",{staticClass:"iconfont icon-download",on:{click:e.download}})]:e._e()],2)]),n("transition",{attrs:{name:"thumbnail-fade"},on:{"after-enter":function(t){return e.change(e.curIndex)}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.thumbnailTransitionShow&&e.showThumbnail&&e.images&&e.images.length>1,expression:"\n          thumbnailTransitionShow &&\n          showThumbnail &&\n          images &&\n          images.length > 1\n        "}],ref:"thumbnail",staticClass:"cool-image-viewer__thumbnail",on:{mouseenter:function(t){return e.mouseEnterThumbnail(!0)},mouseleave:function(t){return e.mouseEnterThumbnail(!1)}}},e._l(e.images,(function(t,o){return n("div",{key:t+"_thumbnail_"+o,ref:"thumbnail",refInFor:!0,staticClass:"cool-image-viewer__thumbnail__inner",class:{current:e.curIndex===o},on:{click:function(t){return e.change(o)}}},[n("img",{attrs:{src:t}})])})),0)]),n("span",{directives:[{name:"show",rawName:"v-show",value:!e.showThumbnail,expression:"!showThumbnail"}],staticClass:"cool-image-viewer__sequence",style:e.sequenceStyle},[e._v(" "+e._s(e.curIndex+1)+" / "+e._s(e.images.length)+" ")])],1)])},a=[],c=(n("b1d6"),n("8bbf")),l=n.n(c);const u=l.a.prototype.$isServer,d=function(){return!u&&document.addEventListener?function(e,t,n){e&&t&&n&&e.addEventListener(t,n,!1)}:function(e,t,n){e&&t&&n&&e.attachEvent("on"+t,n)}}(),h=function(){return!u&&document.removeEventListener?function(e,t,n){e&&t&&e.removeEventListener(t,n,!1)}:function(e,t,n){e&&t&&e.detachEvent("on"+t,n)}}(),m=function(){return!l.a.prototype.$isServer&&!!window.navigator.userAgent.match(/firefox/i)};function f(e){let t=!1;return function(...n){t||(t=!0,window.requestAnimationFrame(o=>{e.apply(this,n),t=!1}))}}function p(e){var t=new Image;t.setAttribute("crossOrigin","anonymous"),t.onload=function(){var n=document.createElement("canvas");n.width=t.width,n.height=t.height;var o=n.getContext("2d");o.drawImage(t,0,0,t.width,t.height);var i=n.toDataURL("image/png"),s=document.createElement("a"),r=new MouseEvent("click");let a=e.split("/"),c=a[a.length-1];s.download=c||"img",s.href=i,s.dispatchEvent(r)},t.src=e}const g={CONTAIN:{name:"contain",icon:"icon-full-screen"},ORIGINAL:{name:"original",icon:"icon-c-scale-to-original"}},w=m()?"DOMMouseScroll":"mousewheel";var v={name:"ImageViewer",data(){return{options:{},handlePosition:"top",mode:g.CONTAIN,visible:!1,images:[],curIndex:0,zIndex:2e3,maskBgColor:"",showDownload:!1,isMouseEnterThumbnail:!1,thumbnailTransitionShow:!1,showThumbnail:!1,transform:{scale:1,deg:0,rotateY:0,offsetX:0,offsetY:0,enableTransition:!1}}},computed:{isSingle(){return this.images.length<=1},isFirst(){return 0===this.curIndex},isLast(){return this.curIndex===this.images.length-1},sequenceStyle(){return"bottom"==this.handlePosition?{top:"10px",bottom:"auto"}:{bottom:"10px",top:"auto"}},actionStyle(){return"bottom"==this.handlePosition?{bottom:this.showThumbnail&&this.images&&this.images.length>1?"100px":"30px",top:"auto"}:{top:"30px",bottom:"auto"}},imgStyle(){const{scale:e,deg:t,rotateY:n,offsetX:o,offsetY:i,enableTransition:s}=this.transform,r={transform:`scale(${e}) rotate(${t}deg) rotateY(${n}deg)`,transition:s?"transform .3s":"","margin-left":o+"px","margin-top":i+"px"};return this.mode===g.CONTAIN&&(r.maxWidth=r.maxHeight="100%"),r}},mounted(){this.deviceSupportInstall(),this.visible=!0},methods:{mouseEnterThumbnail(e){this.isMouseEnterThumbnail=e},change(e){if(!this.showThumbnail)return;this.curIndex=e;let t=this.$refs.thumbnail;if(!t)return;let n=t.clientWidth,o=t.scrollLeft,i=t.children[e].offsetLeft;n-i<160?this.$refs.thumbnail.scrollLeft=n-i<0&&0===o?i-n+160:o+80:i-o<80&&(this.$refs.thumbnail.scrollLeft=i-120)},pre(){if(this.isFirst)return;const e=this.images.length;this.curIndex=(this.curIndex-1+e)%e,this.change(this.curIndex)},next(){if(this.isLast)return;const e=this.images.length;this.curIndex=(this.curIndex+1)%e,this.change(this.curIndex)},handleMouseDown(e){if(0!==e.button)return;const{offsetX:t,offsetY:n}=this.transform,o=e.pageX,i=e.pageY;this._dragHandler=f(e=>{this.transform.offsetX=t+e.pageX-o,this.transform.offsetY=n+e.pageY-i}),d(document,"mousemove",this._dragHandler),d(document,"mouseup",()=>{h(document,"mousemove",this._dragHandler)}),e.preventDefault()},deviceSupportInstall(){this._keyDownHandler=e=>{e.stopPropagation();const t=e.keyCode;switch(console.log(t),t){case 17:this.handleActions("mirror");break;case 27:this.close();break;case 32:this.toggleMode();break;case 37:this.pre();break;case 38:this.handleActions("zoomIn");break;case 39:this.next();break;case 40:this.handleActions("zoomOut");break}},this._mouseWheelHandler=f(e=>{const t=e.wheelDelta?e.wheelDelta:-e.detail;if(this.isMouseEnterThumbnail){let e=-1,n=1,o=0;o=t>0?50*e:50*n,this.$refs.thumbnail.scrollLeft=this.$refs.thumbnail.scrollLeft+o}else t>0?this.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):this.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1})}),d(document,"keydown",this._keyDownHandler),d(document,w,this._mouseWheelHandler)},deviceSupportUninstall(){h(document,"keydown",this._keyDownHandler),h(document,w,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},reset(){this.transform={scale:1,deg:0,rotateY:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode(){const e=Object.keys(g),t=Object.values(g),n=t.indexOf(this.mode),o=(n+1)%e.length;this.mode=g[e[o]],this.reset()},handleActions(e,t={}){const{zoomRate:n,rotateDeg:o,enableTransition:i}={zoomRate:.2,rotateDeg:90,enableTransition:!0,...t},{transform:s}=this;switch(e){case"zoomOut":s.scale>.2&&(s.scale=parseFloat((s.scale-n).toFixed(3)));break;case"zoomIn":s.scale=parseFloat((s.scale+n).toFixed(3));break;case"clocelise":s.deg+=o;break;case"anticlocelise":s.deg-=o;break;case"mirror":s.rotateY+=180;break}s.enableTransition=i},handleTapClose(){this.close()},download(){this.$emit("download",this.images[this.curIndex])},close(){this.deviceSupportUninstall(),this.visible=!1,this.thumbnailTransitionShow=!1,setTimeout(()=>{this.$emit("close"),this.$destroy(),this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},300)},initOptions(e){this.options=e,this.images=e.images||[],this.curIndex=e.curIndex||0,this.showDownload=e.showDownload,this.zIndex=e.zIndex,this.showThumbnail=e.showThumbnail,this.maskBgColor=e.maskBgColor,this.handlePosition=e.handlePosition,this.$nextTick(()=>{this.thumbnailTransitionShow=!0})}}},b=v;n("cb7b");function _(e,t,n,o,i,s,r,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=n,l._compiled=!0),o&&(l.functional=!0),s&&(l._scopeId="data-v-"+s),r?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},l._ssrRegister=c):i&&(c=a?function(){i.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:i),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(e,t){return c.call(t),u(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}var x=_(b,r,a,!1,null,null,null),y=x.exports;const C=()=>{},T={curIndex:0,images:[],showDownload:!1,showThumbnail:!1,handlePosition:"bottom",onClose:C,onDownload:C,zIndex:2e3,maskBgColor:"rgba(0,0,0,0.5)"},k=l.a.extend(y);function I(e=T){let t=new k;return t.initOptions({...T,...e}),t.$mount(),document.body.appendChild(t.$el),t.$on("close",(function(){e.onClose&&e.onClose()})),t.$on("download",(function(t){e.onDownload?e.onDownload(t):p(t)})),{$instance:t,close:t.close}}"undefined"!==typeof window&&window.Vue&&(window.Vue.component("ImageViewer",I),window.Vue.prototype.$imageViewer=I),I.install=e=>{e.prototype.$imageViewer=I};var S=I;t["default"]=S}})}));